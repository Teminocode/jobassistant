<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Job Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .status-dot {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .tabs {
            display: flex;
            border-bottom: 1px solid #e5e7eb;
            background: #f9fafb;
            overflow-x: auto;
        }

        .tab {
            padding: 16px 24px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 14px;
            color: #6b7280;
            transition: all 0.2s;
            white-space: nowrap;
            min-width: 140px;
        }

        .tab.active {
            color: #6366f1;
            background: white;
            border-bottom: 3px solid #6366f1;
        }

        .tab:hover:not(.active) {
            background: #f3f4f6;
        }

        .tab-content {
            display: none;
            padding: 30px;
            min-height: 600px;
        }

        .tab-content.active {
            display: block;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .container {
                margin: 10px;
                border-radius: 12px;
            }
            .header {
                padding: 20px;
            }
            .header h1 {
                font-size: 24px;
            }
            .tabs {
                flex-wrap: wrap;
            }
            .tab {
                min-width: auto;
                flex: 1;
                padding: 12px 16px;
                font-size: 12px;
            }
            .tab-content {
                padding: 20px;
            }
        }

        .card {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 24px;
            transition: all 0.3s ease;
        }

        .card:hover {
            border-color: #6366f1;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.15);
        }

        .card h3 {
            color: #1f2937;
            font-size: 18px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .job-info {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 2px solid #0ea5e9;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .job-info h3 {
            color: #0369a1;
            font-size: 20px;
            margin-bottom: 8px;
        }

        .job-info p {
            color: #0284c7;
            font-size: 14px;
        }

        .btn {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            width: 100%;
            margin-bottom: 12px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.3);
        }

        .btn.secondary {
            background: linear-gradient(135deg, #64748b 0%, #475569 100%);
        }

        .btn.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .btn.loading {
            opacity: 0.7;
            cursor: not-allowed;
            pointer-events: none;
        }

        .btn.loading::after {
            content: '';
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top: 2px solid white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 8px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .input-group {
            margin-bottom: 16px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 600;
            color: #374151;
        }

        .input-group input,
        .input-group textarea,
        .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #d1d5db;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.2s;
        }

        .input-group input:focus,
        .input-group textarea:focus,
        .input-group select:focus {
            outline: none;
            border-color: #6366f1;
        }

        .textarea {
            min-height: 100px;
            resize: vertical;
        }

        .generated-content {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
        }

        .keyword-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 12px;
        }

        .keyword {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .match-score {
            display: flex;
            align-items: center;
            gap: 16px;
            margin-top: 16px;
        }

        .score-circle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 16px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .score-high { background: linear-gradient(135deg, #10b981 0%, #059669 100%); }
        .score-medium { background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); }
        .score-low { background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%); }

        .job-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .job-item {
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .job-item:hover {
            border-color: #6366f1;
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(99, 102, 241, 0.15);
        }

        .job-item h4 {
            font-size: 16px;
            margin-bottom: 4px;
            color: #1f2937;
        }

        .job-item p {
            font-size: 14px;
            color: #6b7280;
        }

        .job-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 8px;
        }

        .status-applied { background: #dbeafe; color: #1d4ed8; }
        .status-interviewing { background: #fef3c7; color: #d97706; }
        .status-saved { background: #d1fae5; color: #059669; }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 2px solid #0ea5e9;
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #0369a1;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 12px;
            color: #0284c7;
            text-transform: uppercase;
            font-weight: 600;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.3);
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.error {
            background: #ef4444;
        }

        .url-input {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 16px;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #6b7280;
        }

        .empty-state h4 {
            font-size: 18px;
            margin-bottom: 8px;
        }

        .empty-state p {
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="notification" id="notification"></div>
    
    <div class="container">
        <div class="header">
            <div class="status-dot"></div>
            <h1>Smart Job Assistant</h1>
            <p>AI-powered job application helper for modern job seekers</p>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="detect">🔍 Job Detector</button>
            <button class="tab" data-tab="analyze">📊 Resume Match</button>
            <button class="tab" data-tab="generate">✨ AI Generator</button>
            <button class="tab" data-tab="tracker">📂 Job Tracker</button>
            <button class="tab" data-tab="settings">⚙️ Settings</button>
        </div>

        <!-- Job Detector Tab -->
        <div class="tab-content active" id="detect">
            <div class="job-info" id="jobInfo">
                <h3>📋 No job detected</h3>
                <p>Paste a job posting URL or job description below to get started</p>
            </div>
            
            <div class="grid">
                <div class="card">
                    <h3>🔗 From URL</h3>
                    <div class="input-group">
                        <label for="jobUrl">Job Posting URL:</label>
                        <input type="url" id="jobUrl" placeholder="https://linkedin.com/jobs/view/..." class="url-input">
                    </div>
                    <button class="btn" id="detectFromUrl">🔍 Analyze Job URL</button>
                </div>
                
                <div class="card">
                    <h3>📝 From Text</h3>
                    <div class="input-group">
                        <label for="jobDescription">Job Description:</label>
                        <textarea id="jobDescription" class="textarea" placeholder="Paste job description here..."></textarea>
                    </div>
                    <button class="btn" id="detectFromText">🎯 Extract Keywords</button>
                </div>
            </div>
            
            <div class="feature-grid">
                <button class="btn secondary" id="highlightKeywords">✨ Show Key Requirements</button>
                <button class="btn success" id="saveCurrentJob" style="display: none;">💾 Save This Job</button>
            </div>
            
            <div class="generated-content" id="detectedKeywords" style="display: none;">
                <h4 style="font-size: 16px; margin-bottom: 12px;">🎯 Key Requirements Found:</h4>
                <div class="keyword-list" id="keywordList"></div>
                <div id="jobRequirements" style="margin-top: 16px;"></div>
            </div>
        </div>

        <!-- Resume Match Tab -->
        <div class="tab-content" id="analyze">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number" id="matchScore">--</div>
                    <div class="stat-label">Overall Match</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="skillsFound">--</div>
                    <div class="stat-label">Skills Match</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="experienceMatch">--</div>
                    <div class="stat-label">Experience Match</div>
                </div>
            </div>

            <div class="grid">
                <div class="card">
                    <h3>📄 Your Resume</h3>
                    <div class="input-group">
                        <label for="resumeText">Paste your resume text:</label>
                        <textarea id="resumeText" class="textarea" placeholder="Paste your complete resume text here..."></textarea>
                    </div>
                </div>
                
                <div class="card">
                    <h3>🎯 Analysis Options</h3>
                    <div class="input-group">
                        <label for="focusArea">Focus Analysis On:</label>
                        <select id="focusArea">
                            <option value="overall">Overall Match</option>
                            <option value="technical">Technical Skills</option>
                            <option value="experience">Experience Level</option>
                            <option value="keywords">Keyword Density</option>
                        </select>
                    </div>
                    <button class="btn" id="analyzeMatch">📊 Analyze Resume Match</button>
                </div>
            </div>
            
            <div class="generated-content" id="analysisResults" style="display: none;">
                <div id="analysisContent"></div>
            </div>
        </div>

        <!-- AI Generator Tab -->
        <div class="tab-content" id="generate">
            <div class="grid">
                <div class="card">
                    <h3>⚙️ Generation Settings</h3>
                    <div class="input-group">
                        <label for="experienceLevel">Your Experience Level:</label>
                        <select id="experienceLevel">
                            <option value="entry">Entry Level (0-2 years)</option>
                            <option value="mid" selected>Mid Level (3-7 years)</option>
                            <option value="senior">Senior Level (8+ years)</option>
                            <option value="executive">Executive Level (10+ years)</option>
                        </select>
                    </div>
                    
                    <div class="input-group">
                        <label for="tone">Writing Tone:</label>
                        <select id="tone">
                            <option value="professional">Professional</option>
                            <option value="confident">Confident</option>
                            <option value="friendly">Friendly</option>
                            <option value="formal">Formal</option>
                        </select>
                    </div>
                </div>
                
                <div class="card">
                    <h3>🎯 Content Generation</h3>
                    <button class="btn" id="generateResume">📝 Resume Bullets</button>
                    <button class="btn" id="generateCover">💌 Cover Letter</button>
                    <button class="btn" id="generateQuestions">🗣️ Interview Prep</button>
                    <button class="btn secondary" id="generateEmail">📧 Follow-up Email</button>
                </div>
            </div>
            
            <div class="generated-content" id="generatedContent" style="display: none;">
                <div id="contentBody"></div>
                <div style="display: flex; gap: 12px; margin-top: 16px;">
                    <button class="btn secondary" id="copyContent">📋 Copy Content</button>
                    <button class="btn success" id="regenerateContent">🔄 Regenerate</button>
                </div>
            </div>
        </div>

        <!-- Job Tracker Tab -->
        <div class="tab-content" id="tracker">
            <div class="grid">
                <div class="card">
                    <div class="input-group">
                        <label for="searchJobs">🔍 Search Jobs:</label>
                        <input type="text" id="searchJobs" placeholder="Search by title, company, or status...">
                    </div>
                </div>
                
                <div class="card">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalJobs">0</div>
                            <div class="stat-label">Total Jobs</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="appliedJobs">0</div>
                            <div class="stat-label">Applied</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="job-list" id="jobList">
                <div class="empty-state">
                    <h4>📂 No jobs saved yet</h4>
                    <p>Use the Job Detector to find and save jobs you're interested in</p>
                </div>
            </div>

            <div class="feature-grid">
                <button class="btn secondary" id="exportJobs">📤 Export All Jobs</button>
                <button class="btn secondary" id="clearAllJobs">🗑️ Clear All Jobs</button>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settings">
            <div class="grid">
                <div class="card">
                    <h3>🎯 Target Preferences</h3>
                    <div class="input-group">
                        <label for="preferredKeywords">Target Keywords:</label>
                        <textarea id="preferredKeywords" class="textarea" placeholder="React, Python, AWS, Machine Learning..."></textarea>
                    </div>

                    <div class="input-group">
                        <label for="industryFocus">Industry Focus:</label>
                        <select id="industryFocus">
                            <option value="tech">Technology</option>
                            <option value="finance">Finance</option>
                            <option value="healthcare">Healthcare</option>
                            <option value="marketing">Marketing</option>
                            <option value="consulting">Consulting</option>
                            <option value="education">Education</option>
                        </select>
                    </div>
                    
                    <button class="btn" id="saveSettings">💾 Save Settings</button>
                </div>
                
                <div class="card">
                    <h3>📊 Usage Statistics</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="statsDetected">0</div>
                            <div class="stat-label">Jobs Analyzed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="statsGenerated">0</div>
                            <div class="stat-label">Content Generated</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 16px;">
                        <p style="font-size: 14px; color: #6b7280;">Success Rate: <span id="statsSuccess" style="font-weight: 600; color: #059669;">--%</span></p>
                        <p style="font-size: 14px; color: #6b7280;">Last Activity: <span id="lastActivity" style="font-weight: 600;">Never</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Main Application Class
        class JobAssistant {
            constructor() {
                this.currentJob = null;
                this.savedJobs = this.loadSavedJobs();
                this.settings = this.loadSettings();
                this.stats = this.loadStats();
                this.lastGenerationType = null;
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateUI();
                this.loadMockData(); // Remove this in production
            }

            loadMockData() {
                // Mock data for demonstration - remove in production
                this.savedJobs = [
                    {
                        id: '1',
                        title: 'Senior Frontend Developer',
                        company: 'TechCorp Inc.',
                        status: 'applied',
                        matchScore: 85,
                        dateAdded: new Date().toISOString(),
                        url: 'https://example.com/job1',
                        keywords: ['React', 'TypeScript', 'Node.js']
                    },
                    {
                        id: '2',
                        title: 'Full Stack Engineer',
                        company: 'StartupXYZ',
                        status: 'interviewing',
                        matchScore: 92,
                        dateAdded: new Date(Date.now() - 86400000).toISOString(),
                        url: 'https://example.com/job2',
                        keywords: ['JavaScript', 'Python', 'AWS']
                    },
                    {
                        id: '3',
                        title: 'React Developer',
                        company: 'Digital Agency',
                        status: 'saved',
                        matchScore: 78,
                        dateAdded: new Date(Date.now() - 172800000).toISOString(),
                        url: 'https://example.com/job3',
                        keywords: ['React', 'CSS', 'GraphQL']
                    }
                ];
                this.updateJobList();
                this.saveData();
            }

            setupEventListeners() {
                // Tab switching
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        this.switchTab(e.target.dataset.tab);
                    });
                });

                // Main buttons
                document.getElementById('detectFromUrl').addEventListener('click', () => this.detectFromUrl());
                document.getElementById('detectFromText').addEventListener('click', () => this.detectFromText());
                document.getElementById('highlightKeywords').addEventListener('click', () => this.highlightKeywords());
                document.getElementById('saveCurrentJob').addEventListener('click', () => this.saveCurrentJob());
                document.getElementById('analyzeMatch').addEventListener('click', () => this.analyzeMatch());
                
                // Generation buttons
                document.getElementById('generateResume').addEventListener('click', () => this.generateContent('resume'));
                document.getElementById('generateCover').addEventListener('click', () => this.generateContent('cover'));
                document.getElementById('generateQuestions').addEventListener('click', () => this.generateContent('questions'));
                document.getElementById('generateEmail').addEventListener('click', () => this.generateContent('email'));
                
                // Utility buttons
                document.getElementById('copyContent').addEventListener('click', () => this.copyContent());
                document.getElementById('regenerateContent').addEventListener('click', () => this.regenerateContent());
                document.getElementById('saveSettings').addEventListener('click', () => this.saveSettings());
                document.getElementById('exportJobs').addEventListener('click', () => this.exportJobs());
                document.getElementById('clearAllJobs').addEventListener('click', () => this.clearAllJobs());

                // Search
                document.getElementById('searchJobs').addEventListener('input', (e) => {
                    this.searchJobs(e.target.value);
                });
            }

            switchTab(tabName) {
                document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
                
                document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
                document.getElementById(tabName).classList.add('active');
            }

            async detectFromUrl() {
                const url = document.getElementById('jobUrl').value.trim();
                if (!url) {
                    this.showNotification('Please enter a job URL!', 'error');
                    return;
                }

                const button = document.getElementById('detectFromUrl');
                this.setButtonLoading(button, 'Analyzing URL...');

                try {
                    // Simulate API call - in production, this would scrape the URL
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    // Mock job extraction from URL
                    this.currentJob = {
                        title: 'Senior React Developer',
                        company: 'Innovation Labs',
                        description: `We are seeking a skilled React developer with experience in TypeScript, Node.js, and AWS. 
                        
                        Requirements:
                        • 5+ years of React development experience
                        • Strong knowledge of TypeScript and JavaScript
                        • Experience with Node.js and Express
                        • Familiarity with AWS services
                        • Understanding of GraphQL and REST APIs
                        • Experience with testing frameworks (Jest, React Testing Library)
                        • Knowledge of CI/CD pipelines
                        
                        Nice to have:
                        • Next.js experience
                        • Docker containerization
                        • Microservices architecture`,
                        keywords: ['React', 'TypeScript', 'Node.js', 'AWS', 'JavaScript', 'GraphQL', 'Jest', 'CI/CD'],
                        url: url,
                        requirements: [
                            '5+ years React experience',
                            'TypeScript proficiency',
                            'Node.js & Express knowledge',
                            'AWS cloud services',
                            'Testing framework experience'
                        ]
                    };

                    this.displayDetectedJob();
                    this.showNotification('Job successfully analyzed from URL!');
                    this.stats.jobsDetected++;
                    this.updateStats();
                    
                } catch (error) {
                    console.error('Error detecting job from URL:', error);
                    this.showNotification('Failed to analyze job URL. Please try again.', 'error');
                } finally {
                    this.resetButton(button, '🔍 Analyze Job URL');
                }
            }

            async detectFromText() {
                const description = document.getElementById('jobDescription').value.trim();
                if (!description) {
                    this.showNotification('Please paste a job description!', 'error');
                    return;
                }

                const button = document.getElementById('detectFromText');
                this.setButtonLoading(button, 'Extracting keywords...');

                try {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    
                    // Mock keyword extraction - in production, this would use NLP
                    const keywords = this.extractKeywords(description);
                    const requirements = this.extractRequirements(description);
                    
                    this.currentJob = {
                        title: 'Job from Description',
                        company: 'Company Name',
                        description: description,
                        keywords: keywords,
                        url: 'Manual Entry',
                        requirements: requirements
                    };

                    this.displayDetectedJob();
                    this.showNotification('Keywords extracted successfully!');
                    this.stats.jobsDetected++;
                    this.updateStats();
                    
                } catch (error) {
                    console.error('Error extracting keywords:', error);
                    this.showNotification('Failed to extract keywords. Please try again.', 'error');
                } finally {
                    this.resetButton(button, '🎯 Extract Keywords');
                }
            }

            extractKeywords(text) {
                // Simple keyword extraction - in production, use proper NLP
                const commonTechKeywords = [
                    'React', 'JavaScript', 'TypeScript', 'Node.js', 'Python', 'Java', 'AWS', 'Docker',
                    'Kubernetes', 'GraphQL', 'REST', 'API', 'MongoDB', 'PostgreSQL', 'Redis',
                    'Git', 'CI/CD', 'Jenkins', 'Agile', 'Scrum', 'TDD', 'Jest', 'CSS', 'HTML',
                    'Vue.js', 'Angular', 'Express', 'Django', 'Flask', 'Spring', 'Microservices'
                ];
                
                const foundKeywords = [];
                const textLower = text.toLowerCase();
                
                commonTechKeywords.forEach(keyword => {
                    if (textLower.includes(keyword.toLowerCase())) {
                        foundKeywords.push(keyword);
                    }
                });
                
                // Add some experience-related keywords
                if (textLower.includes('senior') || textLower.includes('lead')) {
                    foundKeywords.push('Senior Level');
                }
                if (textLower.includes('junior') || textLower.includes('entry')) {
                    foundKeywords.push('Entry Level');
                }
                
                return foundKeywords.slice(0, 12); // Limit to 12 keywords
            }

            extractRequirements(text) {
                // Simple requirements extraction
                const lines = text.split('\n');
                const requirements = [];
                
                lines.forEach(line => {
                    line = line.trim();
                    if (line.startsWith('•') || line.startsWith('-') || line.startsWith('*')) {
                        requirements.push(line.substring(1).trim());
                    } else if (line.includes('years') && line.includes('experience')) {
                        requirements.push(line);
                    }
                });
                
                return requirements.slice(0, 8); // Limit to 8 requirements
            }

            displayDetectedJob() {
                const jobInfo = document.getElementById('jobInfo');
                jobInfo.innerHTML = `
                    <h3>✅ ${this.currentJob.title}</h3>
                    <p><strong>${this.currentJob.company}</strong></p>
                    <p style="margin-top: 8px; font-size: 12px; opacity: 0.8;">Source: ${this.currentJob.url}</p>
                `;

                const keywordsDiv = document.getElementById('detectedKeywords');
                const keywordList = document.getElementById('keywordList');
                keywordList.innerHTML = this.currentJob.keywords.map(keyword => 
                    `<span class="keyword">${keyword}</span>`
                ).join('');

                const requirementsDiv = document.getElementById('jobRequirements');
                if (this.currentJob.requirements && this.currentJob.requirements.length > 0) {
                    requirementsDiv.innerHTML = `
                        <h4 style="font-size: 14px; margin-bottom: 8px; color: #374151;">📋 Key Requirements:</h4>
                        ${this.currentJob.requirements.map(req => 
                            `<p style="font-size: 12px; margin-bottom: 4px; color: #6b7280;">• ${req}</p>`
                        ).join('')}
                    `;
                }

                keywordsDiv.style.display = 'block';
                document.getElementById('saveCurrentJob').style.display = 'block';
            }

            async highlightKeywords() {
                if (!this.currentJob) {
                    this.showNotification('Please detect a job first!', 'error');
                    return;
                }

                // Since this is a web app, we can't highlight on external pages
                // Instead, show the keywords more prominently
                this.showNotification('Key requirements highlighted in the results below!');
                
                // Scroll to keywords if they exist
                const keywordsDiv = document.getElementById('detectedKeywords');
                if (keywordsDiv.style.display !== 'none') {
                    keywordsDiv.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }

            async analyzeMatch() {
                const resumeText = document.getElementById('resumeText').value.trim();
                if (!resumeText) {
                    this.showNotification('Please paste your resume first!', 'error');
                    return;
                }

                if (!this.currentJob) {
                    this.showNotification('Please detect a job first!', 'error');
                    return;
                }

                const button = document.getElementById('analyzeMatch');
                this.setButtonLoading(button, 'Analyzing match...');

                try {
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    // Mock analysis with more sophisticated scoring
                    const focusArea = document.getElementById('focusArea').value;
                    const analysis = this.performMatchAnalysis(resumeText, this.currentJob, focusArea);
                    
                    // Update stats
                    document.getElementById('matchScore').textContent = analysis.overallScore + '%';
                    document.getElementById('skillsFound').textContent = analysis.skillsMatch + '/10';
                    document.getElementById('experienceMatch').textContent = analysis.experienceScore + '%';
                    
                    // Show detailed analysis
                    const resultsDiv = document.getElementById('analysisResults');
                    document.getElementById('analysisContent').innerHTML = `
                        <div class="match-score">
                            <div class="score-circle ${analysis.overallScore >= 80 ? 'score-high' : analysis.overallScore >= 60 ? 'score-medium' : 'score-low'}">
                                ${analysis.overallScore}%
                            </div>
                            <div>
                                <h4 style="font-size: 16px; margin-bottom: 8px; color: #1f2937;">Match Analysis Results</h4>
                                <p style="font-size: 14px; color: #6b7280; line-height: 1.5;">${analysis.summary}</p>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <h4 style="font-size: 14px; margin-bottom: 12px; color: #374151;">📊 Detailed Breakdown:</h4>
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                <div>
                                    <p style="font-size: 13px; margin-bottom: 4px;"><strong>✅ Strengths:</strong></p>
                                    ${analysis.strengths.map(strength => 
                                        `<p style="font-size: 12px; color: #059669; margin-bottom: 2px;">• ${strength}</p>`
                                    ).join('')}
                                </div>
                                <div>
                                    <p style="font-size: 13px; margin-bottom: 4px;"><strong>⚠️ Areas to Highlight:</strong></p>
                                    ${analysis.improvements.map(improvement => 
                                        `<p style="font-size: 12px; color: #d97706; margin-bottom: 2px;">• ${improvement}</p>`
                                    ).join('')}
                                </div>
                            </div>
                        </div>
                    `;
                    resultsDiv.style.display = 'block';
                    
                    this.showNotification('Resume analysis complete!');
                    
                } catch (error) {
                    console.error('Error analyzing match:', error);
                    this.showNotification('Analysis failed. Please try again.', 'error');
                } finally {
                    this.resetButton(button, '📊 Analyze Resume Match');
                }
            }

            performMatchAnalysis(resumeText, job, focusArea) {
                // Mock sophisticated analysis
                const resumeLower = resumeText.toLowerCase();
                const keywordMatches = job.keywords.filter(keyword => 
                    resumeLower.includes(keyword.toLowerCase())
                ).length;
                
                const overallScore = Math.min(95, 60 + (keywordMatches * 4) + Math.floor(Math.random() * 15));
                const skillsMatch = Math.min(10, keywordMatches + Math.floor(Math.random() * 3));
                const experienceScore = Math.min(95, 70 + Math.floor(Math.random() * 25));
                
                const strengths = [
                    'Strong technical skill alignment',
                    'Relevant industry experience',
                    'Good keyword optimization'
                ].slice(0, Math.floor(Math.random() * 2) + 2);
                
                const improvements = [
                    'Include more specific project examples',
                    'Highlight leadership experience',
                    'Add quantifiable achievements'
                ].slice(0, Math.floor(Math.random() * 2) + 2);
                
                let summary = '';
                if (overallScore >= 80) {
                    summary = 'Excellent match! Your background aligns very well with the job requirements. Focus on highlighting your strongest relevant experiences.';
                } else if (overallScore >= 60) {
                    summary = 'Good match with room for improvement. Consider emphasizing transferable skills and relevant project experience.';
                } else {
                    summary = 'Moderate match. Focus on highlighting transferable skills and consider acquiring some of the key technical requirements.';
                }
                
                return {
                    overallScore,
                    skillsMatch,
                    experienceScore,
                    summary,
                    strengths,
                    improvements
                };
            }

            async generateContent(type) {
                if (!this.currentJob) {
                    this.showNotification('Please detect a job first!', 'error');
                    return;
                }

                const button = document.getElementById(`generate${type.charAt(0).toUpperCase() + type.slice(1)}`);
                this.setButtonLoading(button, 'Generating...');
                this.lastGenerationType = type;

                try {
                    await new Promise(resolve => setTimeout(resolve, 2500));
                    
                    const experienceLevel = document.getElementById('experienceLevel').value;
                    const tone = document.getElementById('tone').value;
                    
                    let content = this.generateMockContent(type, experienceLevel, tone);
                    
                    document.getElementById('contentBody').innerHTML = content;
                    document.getElementById('generatedContent').style.display = 'block';
                    
                    this.stats.contentGenerated++;
                    this.updateStats();
                    this.showNotification(`${type.charAt(0).toUpperCase() + type.slice(1)} content generated!`);
                    
                    // Scroll to generated content
                    document.getElementById('generatedContent').scrollIntoView({ 
                        behavior: 'smooth', 
                        block: 'center' 
                    });
                    
                } catch (error) {
                    console.error('Error generating content:', error);
                    this.showNotification('Content generation failed. Please try again.', 'error');
                } finally {
                    this.resetButton(button, this.getButtonText(type));
                }
            }

            generateMockContent(type, experienceLevel, tone) {
                const job = this.currentJob;
                
                switch(type) {
                    case 'resume':
                        return `
                            <h4 style="font-size: 16px; margin-bottom: 12px; color: #1f2937;">📝 Tailored Resume Bullets:</h4>
                            <div style="background: #f8fafc; padding: 16px; border-radius: 8px; border-left: 4px solid #6366f1;">
                                <p style="font-size: 13px; margin-bottom: 8px; line-height: 1.5;">• Developed and maintained scalable ${job.keywords[0] || 'web'} applications serving 100,000+ daily active users, resulting in 25% improved performance</p>
                                <p style="font-size: 13px; margin-bottom: 8px; line-height: 1.5;">• Implemented modern ${job.keywords[1] || 'JavaScript'} solutions and best practices, reducing code complexity by 30% and improving maintainability</p>
                                <p style="font-size: 13px; margin-bottom: 8px; line-height: 1.5;">• Collaborated with cross-functional teams using Agile methodology to deliver 15+ successful product features on schedule</p>
                                <p style="font-size: 13px; margin-bottom: 8px; line-height: 1.5;">• Optimized application performance using ${job.keywords[2] || 'modern tools'}, achieving 40% faster load times and enhanced user experience</p>
                                <p style="font-size: 13px; line-height: 1.5;">• Mentored ${experienceLevel === 'senior' ? '3 junior developers' : '2 team members'} and conducted code reviews, improving team productivity by 20%</p>
                            </div>
                        `;
                    
                    case 'cover':
                        const companyName = job.company || 'Your Company';
                        const jobTitle = job.title || 'this position';
                        return `
                            <h4 style="font-size: 16px; margin-bottom: 12px; color: #1f2937;">💌 Personalized Cover Letter:</h4>
                            <div style="background: #f8fafc; padding: 16px; border-radius: 8px; border-left: 4px solid #8b5cf6;">
                                <p style="font-size: 13px; margin-bottom: 12px; line-height: 1.6;"><strong>Dear ${companyName} Hiring Team,</strong></p>
                                <p style="font-size: 13px; margin-bottom: 12px; line-height: 1.6;">I am excited to apply for the ${jobTitle} position at ${companyName}. With my extensive experience in ${job.keywords.slice(0, 3).join(', ')}, I am confident I can make a significant contribution to your team's continued success.</p>
                                <p style="font-size: 13px; margin-bottom: 12px; line-height: 1.6;">In my ${experienceLevel === 'entry' ? 'recent projects' : 'previous roles'}, I have successfully ${experienceLevel === 'senior' ? 'led development teams and' : ''} delivered scalable solutions using ${job.keywords[0]}. My experience with ${job.keywords[1]} and ${job.keywords[2] || 'modern development practices'} aligns perfectly with your requirements.</p>
                                <p style="font-size: 13px; margin-bottom: 12px; line-height: 1.6;">I am particularly drawn to ${companyName}'s commitment to innovation and would welcome the opportunity to contribute to your mission. I would love to discuss how my skills and passion can benefit your team.</p>
                                <p style="font-size: 13px; line-height: 1.6;"><strong>Best regards,<br>[Your Name]</strong></p>
                            </div>
                        `;
                    
                    case 'questions':
                        return `
                            <h4 style="font-size: 16px; margin-bottom: 12px; color: #1f2937;">🗣️ Interview Preparation Questions:</h4>
                            <div style="display: grid; gap: 16px;">
                                <div style="background: #fef3c7; padding: 12px; border-radius: 8px;">
                                    <p style="font-size: 13px; margin-bottom: 6px; font-weight: 600; color: #92400e;">Technical Questions:</p>
                                    <p style="font-size: 12px; margin-bottom: 4px; color: #b45309;">• How would you optimize a ${job.keywords[0]} application for better performance?</p>
                                    <p style="font-size: 12px; margin-bottom: 4px; color: #b45309;">• Explain your experience with ${job.keywords[1]} and how you've used it in previous projects</p>
                                    <p style="font-size: 12px; color: #b45309;">• What are some best practices you follow when working with ${job.keywords[2] || 'modern frameworks'}?</p>
                                </div>
                                <div style="background: #dbeafe; padding: 12px; border-radius: 8px;">
                                    <p style="font-size: 13px; margin-bottom: 6px; font-weight: 600; color: #1d4ed8;">Behavioral Questions:</p>
                                    <p style="font-size: 12px; margin-bottom: 4px; color: #2563eb;">• Tell me about a challenging project you worked on and how you overcame obstacles</p>
                                    <p style="font-size: 12px; margin-bottom: 4px; color: #2563eb;">• How do you handle tight deadlines and competing priorities?</p>
                                    <p style="font-size: 12px; color: #2563eb;">• Describe a time when you had to learn a new technology quickly</p>
                                </div>
                                <div style="background: #d1fae5; padding: 12px; border-radius: 8px;">
                                    <p style="font-size: 13px; margin-bottom: 6px; font-weight: 600; color: #065f46;">Questions to Ask Them:</p>
                                    <p style="font-size: 12px; margin-bottom: 4px; color: #047857;">• What does a typical day look like for this role?</p>
                                    <p style="font-size: 12px; margin-bottom: 4px; color: #047857;">• What are the biggest challenges facing the team right now?</p>
                                    <p style="font-size: 12px; color: #047857;">• How do you measure success in this position?</p>
                                </div>
                            </div>
                        `;
                    
                    case 'email':
                        return `
                            <h4 style="font-size: 16px; margin-bottom: 12px; color: #1f2937;">📧 Professional Follow-up Email:</h4>
                            <div style="background: #f8fafc; padding: 16px; border-radius: 8px; border-left: 4px solid #10b981;">
                                <p style="font-size: 13px; margin-bottom: 12px; line-height: 1.6;"><strong>Subject:</strong> Thank you for the ${job.title} interview</p>
                                <p style="font-size: 13px; margin-bottom: 12px; line-height: 1.6;"><strong>Dear [Interviewer Name],</strong></p>
                                <p style="font-size: 13px; margin-bottom: 12px; line-height: 1.6;">Thank you for taking the time to discuss the ${job.title} position with me today. I enjoyed learning more about ${job.company}'s innovative approach to ${job.keywords[0]} development and the exciting challenges your team is working on.</p>
                                <p style="font-size: 13px; margin-bottom: 12px; line-height: 1.6;">Our conversation reinforced my enthusiasm for this opportunity. I'm particularly excited about the prospect of contributing to [specific project/initiative discussed] and bringing my experience with ${job.keywords.slice(0, 2).join(' and ')} to help achieve your goals.</p>
                                <p style="font-size: 13px; margin-bottom: 12px; line-height: 1.6;">Please don't hesitate to reach out if you need any additional information. I look forward to hearing about the next steps in the process.</p>
                                <p style="font-size: 13px; line-height: 1.6;"><strong>Best regards,<br>[Your Name]</strong></p>
                            </div>
                        `;
                    
                    default:
                        return '<p>Content type not supported yet.</p>';
                }
            }

            getButtonText(type) {
                const buttons = {
                    'resume': '📝 Resume Bullets',
                    'cover': '💌 Cover Letter',
                    'questions': '🗣️ Interview Prep',
                    'email': '📧 Follow-up Email'
                };
                return buttons[type] || 'Generate';
            }

            async regenerateContent() {
                if (!this.lastGenerationType) {
                    this.showNotification('No content to regenerate!', 'error');
                    return;
                }
                
                await this.generateContent(this.lastGenerationType);
            }

            saveCurrentJob() {
                if (!this.currentJob) {
                    this.showNotification('No job to save!', 'error');
                    return;
                }
                
                const existingJob = this.savedJobs.find(job => 
                    job.title === this.currentJob.title && job.company === this.currentJob.company
                );
                
                if (existingJob) {
                    this.showNotification('Job already saved!', 'error');
                    return;
                }
                
                const job = {
                    ...this.currentJob,
                    id: Date.now().toString(),
                    status: 'saved',
                    dateAdded: new Date().toISOString(),
                    matchScore: Math.floor(Math.random() * 30) + 70
                };
                
                this.savedJobs.unshift(job); // Add to beginning
                this.updateJobList();
                this.saveData();
                this.showNotification('Job saved successfully!');
            }

            updateJobList() {
                const jobList = document.getElementById('jobList');
                
                if (this.savedJobs.length === 0) {
                    jobList.innerHTML = `
                        <div class="empty-state">
                            <h4>📂 No jobs saved yet</h4>
                            <p>Use the Job Detector to find and save jobs you're interested in</p>
                        </div>
                    `;
                } else {
                    jobList.innerHTML = this.savedJobs.map(job => `
                        <div class="job-item" onclick="jobAssistant.selectJob('${job.id}')">
                            <h4>${job.title}</h4>
                            <p style="margin-bottom: 4px;">${job.company}</p>
                            <p style="font-size: 12px; color: #6b7280;">Added: ${new Date(job.dateAdded).toLocaleDateString()}</p>
                            <p style="font-size: 12px; color: #6b7280;">Match: ${job.matchScore}%</p>
                            <span class="job-status status-${job.status}">${job.status.toUpperCase()}</span>
                        </div>
                    `).join('');
                }
                
                document.getElementById('totalJobs').textContent = this.savedJobs.length;
                document.getElementById('appliedJobs').textContent = this.savedJobs.filter(j => j.status === 'applied').length;
            }

            selectJob(jobId) {
                const job = this.savedJobs.find(j => j.id === jobId);
                if (job) {
                    this.currentJob = job;
                    this.switchTab('detect');
                    this.displayDetectedJob();
                    this.showNotification('Job loaded successfully!');
                }
            }

            searchJobs(query) {
                if (!query.trim()) {
                    this.updateJobList();
                    return;
                }
                
                const filteredJobs = this.savedJobs.filter(job => 
                    job.title.toLowerCase().includes(query.toLowerCase()) ||
                    job.company.toLowerCase().includes(query.toLowerCase()) ||
                    job.status.toLowerCase().includes(query.toLowerCase())
                );
                
                const jobList = document.getElementById('jobList');
                if (filteredJobs.length === 0) {
                    jobList.innerHTML = `
                        <div class="empty-state">
                            <h4>🔍 No matching jobs found</h4>
                            <p>Try adjusting your search terms</p>
                        </div>
                    `;
                } else {
                    jobList.innerHTML = filteredJobs.map(job => `
                        <div class="job-item" onclick="jobAssistant.selectJob('${job.id}')">
                            <h4>${job.title}</h4>
                            <p style="margin-bottom: 4px;">${job.company}</p>
                            <p style="font-size: 12px; color: #6b7280;">Added: ${new Date(job.dateAdded).toLocaleDateString()}</p>
                            <span class="job-status status-${job.status}">${job.status.toUpperCase()}</span>
                        </div>
                    `).join('');
                }
            }

            copyContent() {
                const contentBody = document.getElementById('contentBody');
                const textContent = contentBody.textContent || contentBody.innerText;
                
                navigator.clipboard.writeText(textContent).then(() => {
                    this.showNotification('Content copied to clipboard!');
                }).catch(() => {
                    this.showNotification('Failed to copy content', 'error');
                });
            }

            exportJobs() {
                if (this.savedJobs.length === 0) {
                    this.showNotification('No jobs to export!', 'error');
                    return;
                }
                
                const data = {
                    exportDate: new Date().toISOString(),
                    totalJobs: this.savedJobs.length,
                    jobs: this.savedJobs
                };
                
                const jsonString = JSON.stringify(data, null, 2);
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `job-tracker-export-${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                this.showNotification('Jobs exported successfully!');
            }

            clearAllJobs() {
                if (this.savedJobs.length === 0) {
                    this.showNotification('No jobs to clear!', 'error');
                    return;
                }
                
                if (confirm('Are you sure you want to delete all saved jobs? This action cannot be undone.')) {
                    this.savedJobs = [];
                    this.updateJobList();
                    this.saveData();
                    this.showNotification('All jobs cleared successfully!');
                }
            }

            saveSettings() {
                this.settings.preferredKeywords = document.getElementById('preferredKeywords').value;
                this.settings.industryFocus = document.getElementById('industryFocus').value;
                this.saveData();
                this.showNotification('Settings saved successfully!');
            }

            // Utility methods
            setButtonLoading(button, text) {
                button.textContent = text;
                button.classList.add('loading');
                button.disabled = true;
            }

            resetButton(button, text) {
                button.textContent = text;
                button.classList.remove('loading');
                button.disabled = false;
            }

            updateStats() {
                this.stats.lastActivity = new Date().toISOString();
                document.getElementById('statsDetected').textContent = this.stats.jobsDetected;
                document.getElementById('statsGenerated').textContent = this.stats.contentGenerated;
                
                const successRate = this.stats.jobsDetected > 0 ? 
                    Math.round((this.stats.contentGenerated / this.stats.jobsDetected) * 100) : 0;
                document.getElementById('statsSuccess').textContent = successRate + '%';
                document.getElementById('lastActivity').textContent = 
                    new Date(this.stats.lastActivity).toLocaleDateString();
                
                this.saveData();
            }

            // Data persistence
            loadSavedJobs() {
                try {
                    const saved = localStorage.getItem('jobAssistant_jobs');
                    return saved ? JSON.parse(saved) : [];
                } catch (error) {
                    console.error('Error loading saved jobs:', error);
                    return [];
                }
            }

            loadSettings() {
                try {
                    const saved = localStorage.getItem('jobAssistant_settings');
                    return saved ? JSON.parse(saved) : {
                        preferredKeywords: '',
                        industryFocus: 'tech'
                    };
                } catch (error) {
                    console.error('Error loading settings:', error);
                    return {
                        preferredKeywords: '',
                        industryFocus: 'tech'
                    };
                }
            }

            loadStats() {
                try {
                    const saved = localStorage.getItem('jobAssistant_stats');
                    return saved ? JSON.parse(saved) : {
                        jobsDetected: 0,
                        contentGenerated: 0,
                        lastActivity: new Date().toISOString()
                    };
                } catch (error) {
                    console.error('Error loading stats:', error);
                    return {
                        jobsDetected: 0,
                        contentGenerated: 0,
                        lastActivity: new Date().toISOString()
                    };
                }
            }

            saveData() {
                try {
                    localStorage.setItem('jobAssistant_jobs', JSON.stringify(this.savedJobs));
                    localStorage.setItem('jobAssistant_settings', JSON.stringify(this.settings));
                    localStorage.setItem('jobAssistant_stats', JSON.stringify(this.stats));
                } catch (error) {
                    console.error('Error saving data:', error);
                }
            }

            updateUI() {
                // Update settings inputs
                document.getElementById('preferredKeywords').value = this.settings.preferredKeywords;
                document.getElementById('industryFocus').value = this.settings.industryFocus;
                
                // Update stats
                this.updateStats();
                this.updateJobList();
            }

            showNotification(message, type = 'success') {
                const notification = document.getElementById('notification');
                notification.textContent = message;
                notification.className = `notification ${type} show`;
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 4000);
            }
        }

        // Initialize the application
        const jobAssistant = new JobAssistant();
        
        // Optional: Service Worker for PWA functionality
        // Uncomment this when you create a sw.js file for offline functionality
        /*
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
        */
    </script>
</body>
</html>
                    